<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.emucoo.mapper.TFrontPlanMapper" >
  <resultMap id="BaseResultMap" type="com.emucoo.model.TFrontPlan" >
    <!--
      WARNING - @mbg.generated
    -->
    <id column="id" property="id" jdbcType="BIGINT" />
    <result column="loop_plan_id" property="loopPlanId" jdbcType="BIGINT" />
    <result column="shop_id" property="shopId" jdbcType="BIGINT" />
    <result column="plan_date" property="planDate" jdbcType="DATE" />
    <result column="status" property="status" jdbcType="BIT" />
    <result column="modify_time" property="modifyTime" jdbcType="TIMESTAMP" />
    <result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
    <result column="plan_precise_time" property="planPreciseTime" jdbcType="VARCHAR" />
    <result column="report_id" property="reportId" jdbcType="BIGINT" />
    <result column="check_form_ids" property="checkFormIds" jdbcType="VARCHAR" />
    <result column="remind_type" property="remindType" jdbcType="BIT" />
    <result column="remark" property="remark" jdbcType="VARCHAR" />
    <result column="actual_execute_time" property="actualExecuteTime" jdbcType="VARCHAR" />
    <result column="actual_execute_address" property="actualExecuteAddress" jdbcType="VARCHAR" />
    <result column="actual_remind_time" property="actualRemindTime" jdbcType="TIMESTAMP" />
    <result column="arranger_id" property="arrangerId" jdbcType="BIGINT" />
    <result column="arrangee_id" property="arrangeeId" jdbcType="BIGINT" />
    <result column="create_user_id" property="createUserId" jdbcType="BIGINT" />
    <result column="modify_user_id" property="modifyUserId" jdbcType="BIGINT" />
    <result column="is_del" property="isDel" jdbcType="BIT" />
    <result column="org_id" property="orgId" jdbcType="BIGINT" />
  </resultMap>

  <select id="countTodayPlanOfUser" resultType="java.lang.Integer" >
    select count(id)
    from t_front_plan
    where arrangee_id=#{userId} and status=0 and DATE_FORMAT(plan_date,'%Y-%m-%d') = #{today}
  </select>

  <select id="listTodayPlanOfUser" resultMap="BaseResultMap">
    select * from t_front_plan
    where arrangee_id=#{userId} and status=0 and DATE_FORMAT(plan_date,'%Y-%m-%d') = #{today}
  </select>

  <insert id="addUnArrangeToPlan" parameterType="com.emucoo.model.TFrontPlan">
    INSERT INTO t_front_plan
    (
      shop_id,
      loop_plan_id,
      status,
      create_time,
      modify_time,
      create_user_id,
      modify_user_id,
      org_id,
      is_del
    ) values (
      #{shop.id},
      #{loopPlanId},
      #{status},
      #{createTime},
      #{modifyTime},
      #{createUserId},
      #{modifyUserId},
      #{orgId},
      #{isDel}
    )
  </insert>
</mapper>